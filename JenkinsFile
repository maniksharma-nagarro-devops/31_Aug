pipeline {
    agent any
    tools {
        // Install the Maven version configured as "M3" and add it to the path.
        maven "maven3"
    }
    // parameters {
    //     choice(name: 'ENVIRONMENT',
    //     choices: ['DEVELOPMENT', 'PRODUCTION'],
    //     description: 'Choose the Environment to Work On')
    // }

 

    stages {

     
        stage("Build the code"){
            steps{
                sh "ls -a"

 

              sh 'mvn -f pom.xml install'
            }

        }


        // stage("SonarQube Analysis")
        // {
        //     steps
        //     {
        //         withSonarQubeEnv("SonarQube")
        //         {
        //             sh 'mvn -f Assignment/pom.xml clean install sonar:sonar -Dsonar.projectKey=Pipeline-jenkins -Dsonar.projectName=Mini-assignment'
        //         }
        //     }
        // }

     

       

        stage('create image for docker') {
            steps{
                sh 'docker build -t manik_images_dev:latest .'
            }
        }

 

        	stage('Run docker image'){
			steps{
		//	sh "chmod +x -R ${env.WORKSPACE}"
		//	sh "./container_check.sh"
			// sh 'docker run --name dev -p 8090:80 -d manik_images_dev:latest tail -f /dev/null'
			//	sh 'docker run --name dev -p 8090:80/tcp -d manik_images_dev:latest'
			sh 'docker run --name dev -p 9090:8080 manik_images_dev:latest'
			}
		}
    }

}
